---
title: Network_Peering_Gateway
tags:
  - NHN_Network
date: 2024_06_25
reference: 
link:
  - https://docs.nhncloud.com/ko/Network/Peering%20Gateway/ko/overview/
---
# 목차
- [[#Network > Peering Gateway > 개요|Network > Peering Gateway > 개요]]
	- [[#Network > Peering Gateway > 개요#주요 기능|주요 기능]]
- [[#Network > Peering Gateway > 콘솔 사용 가이드|Network > Peering Gateway > 콘솔 사용 가이드]]
- [[#피어링|피어링]]
- [[#리전 피어링|리전 피어링]]
	- [[#리전 피어링#리전 피어링 생성|리전 피어링 생성]]
	- [[#리전 피어링#피어 리전의 VPC ID 확인|피어 리전의 VPC ID 확인]]
- [[#프로젝트 피어링|프로젝트 피어링]]
	- [[#프로젝트 피어링#프로젝트 피어링 생성|프로젝트 피어링 생성]]
	- [[#프로젝트 피어링#프로젝트 피어링 허용|프로젝트 피어링 허용]]
	- [[#프로젝트 피어링#피어 프로젝트의 VPC ID 확인|피어 프로젝트의 VPC ID 확인]]
	- [[#프로젝트 피어링#피어 프로젝트의 테넌트 ID 확인|피어 프로젝트의 테넌트 ID 확인]]
- [[#공통기능|공통기능]]
	- [[#공통기능#라우트|라우트]]
		- [[#라우트#라우트 생성|라우트 생성]]
		- [[#라우트#라우트 삭제|라우트 삭제]]

## Network > Peering Gateway > 개요

Peering Gateway 서비스를 사용하면 서로 다른 두 개의 가상 사설 네트워크를 연결할 수 있습니다. 서로 다른 두 **VPC**를 연결하여, **VPC**에 할당된 사설 IP를 기반으로 상대 **VPC** 내의 리소스에 직접 액세스할 수 있습니다.

### 주요 기능

Peering Gateway 서비스에서 제공하는 피어링은 다음과 같습니다.

- 피어링
    - 동일 리전, 동일 프로젝트의 서로 다른 두 개의 VPC를 연결하는 기능입니다.
    - 연결된 피어 VPC의 네트워크 범위에 대한 라우트를 추가해 연결된 피어 VPC와 통신할 수 있습니다.
- 리전 피어링
    - 다른 리전, 동일 프로젝트의 서로 다른 두 개의 VPC를 연결하는 기능입니다.
    - 다른 리전에 있는 연결된 피어 VPC의 네트워크 범위에 대한 라우트를 추가해 연결된 피어 VPC와 통신할 수 있습니다.
- 프로젝트 피어링
    - 동일 리전, 다른 프로젝트의 서로 다른 두 개의 VPC를 연결하는 기능입니다.
    - 다른 프로젝트에 있는 연결된 피어 VPC의 네트워크 범위에 대한 라우트를 추가해 연결된 피어 VPC와 통신할 수 있습니다.

## Network > Peering Gateway > 콘솔 사용 가이드

콘솔에서 Peering Gateway 서비스를 사용하는 방법을 설명합니다.

## 피어링

**피어링**은 서로 다른 두 개의 **VPC**를 연결하는 기능입니다.
보통의 경우 VPC는 네트워크 영역이 다르기 때문에 서로 통신이 불가능합니다.
**플로팅 IP**를 이용해 연결할 수는 있으나, 네트워크 사용량에 따라 추가로 비용을 지불해야 합니다.
하지만, 피어링 기능을 사용하면 추가 비용 지불 없이 두 개의 **VPC**를 연결할 수 있습니다.

- 피어링은 서로 다른 두 VPC를 연결합니다. VPC를 건너서 또 다른 VPC로 연결은 지원하지 않습니다. `A <-> B <-> C` 연결에서 `A`와 `C`는 연결되지 않습니다.
- 피어 VPC를 경유하여 다른 VPC로 연결을 원하는 경우 피어링에서 제공되는 **라우트** 설정을 이용하여 VM 인스턴스를 경유하여 패킷이 전달 되도록 설정해야 합니다.
- 두 VPC의 IP 주소 영역이 겹치면 사용할 수 없습니다.  
    IP 주소 영역 한쪽이 다른 한쪽과 포함 관계가 되어서는 안 되며, 이런 경우 피어링 생성에 실패합니다.
- 한국 리전을 제외한 나머지 리전에서는 **기본 라우팅 테이블**에 연결되지 않은 서브넷으로는 통신이 불가능합니다.
    - 한국 리전은 피어링을 생성한 후, 피어링한 양쪽 VPC의 라우팅 테이블에 별도의 라우트를 설정해야 통신이 가능합니다.
        - 라우트의 **대상 CIDR**에 상대 VPC의 IP 주소 영역을 입력하고, 게이트웨이 목록에서 피어링의 이름을 갖는 **PEERING** 항목을 선택하여 라우트를 추가합니다.
        - 라우트를 추가한 라우팅 테이블에 연결된 서브넷으로만 통신이 가능합니다.
        - 기본 라우팅 테이블이 아닌 라우팅 테이블도 라우트를 추가하면 라우팅 테이블에 연결된 서브넷에서 피어 통신이 가능합니다.
        - 피어링 생성 시 서브넷이 없는 VPC를 지정하면 피어링은 생성에 실패합니다.

## 리전 피어링

**리전 피어링**은 서로 다른 리전에 생성된 두 개의 **VPC**를 연결하는 기능입니다.
같은 리전의 VPC는 피어링을 이용하여 연결할 수 있으나 리전이 다른 VPC를 연결할 수는 없습니다. 하지만, 리전 피어링을 이용하면 리전이 다른 두 개의 VPC를 연결할 수 있습니다.

- 리전 피어링은 서로 다른 리전의 두 VPC를 연결합니다. 다른 VPC를 건너서 또 다른 VPC로 연결하는 것은 지원하지 않습니다. 예를 들어 `A <-> B <-> C` 연결에서 `A`와 `C`는 연결되지 않습니다.
- 피어 VPC를 경유하여 다른 VPC로 연결을 원하는 경우 피어링에서 제공되는 **라우트** 설정을 이용하여 VM 인스턴스를 경유하여 패킷이 전달 되도록 설정해야 합니다.
- 리전 피어링은 **한국(평촌)** 리전과 **한국(판교)** 리전의 VPC에서만 이용할 수 있습니다.
- 동일 계정 동일 프로젝트의 두 개의 VPC만 연결이 가능합니다.
- 리전 피어링을 생성하면 연결된 다른 리전에서 자동으로 생성됩니다.
- 리전 피어링을 삭제하면 연결된 다른 리전에서 자동으로 삭제됩니다.
- 두 VPC의 IP 주소 영역이 겹치면 사용할 수 없습니다.
- 중복된 VPC 연결은 생성할 수 없습니다.
- 피어링된 양쪽 VPC의 **라우팅 테이블**에 별도의 **라우트**를 설정해야 통신이 가능합니다.
    - 라우트의 **대상 CIDR**에 상대 VPC의 IP 주소 영역을 입력하고, 게이트웨이 목록에서 리전 피어링의 이름을 갖는 **INTER_REGION_PEERING** 항목을 선택해 라우트를 추가합니다.
    - 라우트를 추가한 라우팅 테이블에 연결된 서브넷으로만 통신이 가능합니다.
    - 기본 라우팅 테이블이 아닌 라우팅 테이블에 라우트를 추가하면 라우팅 테이블에 연결된 서브넷에서 피어링 통신이 가능합니다.
    - 리전 피어링 생성 시 서브넷이 없는 VPC를 지정하면 리전 피어링은 생성에 실패합니다.

### 리전 피어링 생성

1. **Network > Peering Gateway > 리전 피어링**으로 이동합니다.
2. **리전 피어링 생성** 버튼을 클릭합니다.
3. **이름**, **로컬 VPC**, **피어 리전**, **피어 VPC ID**를 입력합니다.

> [!NOTE]
> #### 피어 VPC ID
> **피어 VPC ID** 확인 방법은 아래 "피어 리전의 VPC ID 확인" 내용을 참고하시기 바랍니다.

### 피어 리전의 VPC ID 확인

리전 피어링을 생성하려면 다른 리전에서 피어링 대상이 되는 VPC의 **VPC ID**를 알아야 합니다. 피어 리전의 VPC ID를 확인하는 방법은 다음과 같습니다.

1. 피어 리전의 콘솔 화면에 접속합니다.
2. **Network > VPC > 관리**로 이동합니다.
3. 피어링 대상 VPC를 선택합니다.
4. **기본 정보 > VPC 이름**에 표기된 UUID 값을 복사합니다.

## 프로젝트 피어링

**프로젝트 피어링**은 서로 다른 프로젝트에 생성된 두 개의 **VPC**를 연결하는 기능입니다.
같은 프로젝트의 VPC는 피어링을 이용하여 연결할 수 있으나 프로젝트가 다른 VPC를 연결할 수는 없습니다. 하지만, 프로젝트 피어링 기능을 이용하면 프로젝트가 다른 두 개의 VPC를 연결할 수 있습니다.

- 프로젝트 피어링은 서로 다른 프로젝트의 두 VPC를 연결합니다. 다른 VPC를 건너서 또 다른 VPC로 연결하는 것은 지원하지 않습니다. 예를 들어 `A <-> B <-> C` 연결에서 `A`와 `C`는 연결되지 않습니다.
- 피어 VPC를 경유하여 다른 VPC로 연결을 원하는 경우 피어링에서 제공되는 **라우트** 설정을 이용하여 VM 인스턴스를 경유하여 패킷이 전달 되도록 설정해야 합니다.
- 프로젝트 피어링은 한국(평촌) 리전과 한국(판교) 리전의 VPC에서만 이용할 수 있습니다.
- 동일 리전 서로 다른 프로젝트의 두 개의 VPC만 연결이 가능합니다.
- 프로젝트 피어링을 생성하면 연결된 다른 프로젝트에서 자동으로 생성됩니다.
- 프로젝트 피어링을 삭제하면 연결된 다른 프로젝트에서 자동으로 삭제됩니다.
- 두 VPC의 IP 주소 영역이 겹치면 사용할 수 없습니다.
- 중복된 VPC 연결은 생성할 수 없습니다.
- 피어링된 양쪽 VPC의 **라우팅 테이블**에 별도의 **라우트**를 설정해야 통신이 가능합니다.
    - 라우트의 **대상 CIDR**에 상대 VPC의 IP 주소 영역을 입력하고, 게이트웨이 목록에서 프로젝트 피어링의 이름을 갖는 **INTER_PROJECT_PEERING** 항목을 선택해 라우트를 추가합니다.
    - 라우트를 추가한 라우팅 테이블에 연결된 서브넷으로만 통신이 가능합니다.
    - 기본 라우팅 테이블이 아닌 라우팅 테이블에 라우트를 추가하면 라우팅 테이블에 연결된 서브넷에서 피어링 통신이 가능합니다.
    - 프로젝트 피어링 생성 시 서브넷이 없는 VPC를 지정하면 프로젝트 피어링은 생성에 실패합니다.

### 프로젝트 피어링 생성

**프로젝트 피어링**을 생성하려면 피어 프로젝트의 **프로젝트 피어링 허용**에 내 프로젝트의 **테넌트 ID**와 **VPC ID**가 허용되어 있어야 합니다.
프로젝트 피어링을 생성하기 전에 피어 프로젝트의 관리자에게 **테넌트 ID**와 **VPC ID**를 전달하고 **프로젝트 피어링 허용**에 정보 등록을 요청해야 합니다.
피어 프로젝트에서 정보 등록이 완료되면 다음 절차에 따라 프로젝트 피어링을 생성할 수 있습니다.

1. **Network > Peering Gateway > 프로젝트 피어링**으로 이동합니다.
2. **프로젝트 피어링 생성** 버튼을 클릭합니다.
3. **이름**, **로컬 VPC**, **피어 리전**, **피어 테넌트 ID**, **피어 VPC ID**를 입력합니다.  
    
> [!NOTE] 피어 테넌트 ID, 피어 VPC ID  
> 피어 테넌트 ID와 피어 VPC ID 확인 방법은 아래 "피어 프로젝트의 피어 테넌트 ID 확인" 내용을 참고하시기 바랍니다.

### 프로젝트 피어링 허용

**프로젝트 피어링** 요청을 받는 쪽에서 설정을 합니다. 요청을 보내는 상대방의 **테넌트 ID**와 **VPC ID**를 입력하여 피어가 보내는 프로젝트 피어링 요청을 수락 할 수 있게 합니다.

1. **Network > Peering Gateway > 프로젝트 피어링** 으로 이동 합니다.
2. **프로젝트 피어링 허용** 버튼을 클릭 합니다.
3. **이름**, **피어 테넌트 ID**, **피어 VPC**를 입력하고 확인 버튼을 클릭합니다.

### 피어 프로젝트의 VPC ID 확인

**프로젝트 피어링**을 생성하기 위해서는 피어 프로젝트에서 피어링 대상이 되는 VPC의 **VPC ID**를 알아야 합니다.다음 절차로 피어 프로젝트의 **VPC ID**를 확인 할 수 있습니다.

> [!NOTE] 피어 프로젝트에 접근 권한이 없을시 피어 프로젝트의 관리자에게 VPC ID를 제공받기 바랍니다.

1. 피어 프로젝트의 콘솔 화면에 접속합니다.
2. **Network > VPC > 관리**로 이동합니다.
3. 피어링 대상 VPC를 선택합니다.
4. **기본 정보 > VPC 이름** 에 표기된 UUID 값을 복사합니다.

### 피어 프로젝트의 테넌트 ID 확인

**프로젝트 피어링**을 생성하기 위해서는 피어 프로젝트에서 **테넌트 ID**를 알아야 합니다.
다음 절차로 피어 프로젝트의 **테넌트 ID**를 확인 할 수 있습니다.

> [!NOTE] 피어 프로젝트에 접근 권한이 없을시 피어 프로젝트의 관리자에게 테넌트 ID를 제공받기 바랍니다.

1. 피어 프로젝트의 콘솔 화면에 접속합니다.
2. **Network > VPC > 관리**로 이동합니다.
3. 피어링 대상 이나 화면에 표기되는 VPC중 아무거나 1개를 선택합니다.
4. **기본 정보 > 테넌트 ID** 에 표기된 ID 값을 복사합니다.

## 공통기능

피어링(피어링, 리전 피어링, 프로젝트 피어링)에서 제공되는 공통 기능을 설명합니다.

### 라우트

피어링에서 제공하는 **라우트** 설정을 이용하면 피어 VPC의 VM 인스턴스를 경유하여 다른 VPC로 트래픽을 전달하는 구성을 할 수 있습니다. 피어링의 라우트는 피어링으로부터 유입된 모든 트래픽을 처리할 VM 인스턴스의 포트 및 가상 IP 포트를 지정하여 설정할 수 있습니다. 라우트의 게이트웨이가 되는 VM 인스턴스에는 Network Virtual Appliance VM을 배치하여 VM 인스턴스 내부에서 트래픽을 제어하고 다른 피어링으로 트래픽을 전달할 수 있습니다. * 피어링으로 허브 & 스포크(Hub & Spoke) 형태의 VPC 연결을 구성하고 허브 VPC에 위치한 Network Virtual Appliance로 모든 트래픽을 제어하고자 하는 구성은 피어링의 라우팅 기능을 활용하여 구성할 수 있습니다.

> [!NOTE] 현재는 한국(평촌), 한국(판교) 리전에서만 기능이 제공됩니다.

#### 라우트 생성

1. 라우트 설정을 원하는 피어링으로 선택합니다.
2. 하단 탭에서 라우트를 선택합니다.
3. **라우트 변경** 선택합니다.
    
> [!NOTE]
> 피어링인 경우 두 가지 버튼이 존재합니다. **피어 라우트 변경**은 피어링 생성 시 선택한 **피어 VPC**에 라우트를 추가하는 것이며, **로컬 라우트 변경**은 **로컬 VPC** 위치를 의미합니다.  
    
4. **+** 버튼을 클릭합니다.
5. 대상 CIDR을 입력합니다.
6. 게이트웨이를 선택합니다.
    
> [!NOTE]
> 게이트웨이는 인스턴스와 가상 IP만 선택이 가능합니다.  
    
7. **확인** 버튼을 클릭합니다.

#### 라우트 삭제

1. 라우트 설정 삭제를 원하는 피어링 선택합니다.
2. 하단 탭에서 라우트 선택합니다.
3. **라우트 변경** 버튼을 클릭합니다.
    
> [!NOTE]
> 피어링인 경우 두 가지 버튼이 존재합니다. **피어 라우트 변경**은 피어링 생성 시 선택한 **피어 VPC**에 라우트를 추가하는 것이며, **로컬 라우트 변경**은 **로컬 VPC** 위치를 의미합니다.  
    
4. 삭제 대상의 **-** 버튼을 클릭합니다.
5. **확인** 버튼을 클릭합니다.