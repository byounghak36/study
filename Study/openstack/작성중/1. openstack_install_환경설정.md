## 하드웨어 세팅

```bash
# OS Ubuntu 22.04 LTS
# controller node
192.168.1.31    con01
192.168.1.159   com01
192.168.1.115   com02
```

## 환경설정

- **NTP 설정**

  controller node   

  ​	신뢰 할 수 있는 NTP 서버를 등록

  ```bash
  apt install chrony
  vim /etc/chrony/chrony.conf
  ~
  # About using servers from the NTP Pool Project in general see (LP: #104525).
  # Approved by Ubuntu Technical Board on 2011-02-08.
  # See http://www.pool.ntp.org/join.html for more information.
  pool ntp.ubuntu.com        iburst maxsources 4
  pool 0.ubuntu.pool.ntp.org iburst maxsources 1
  pool 1.ubuntu.pool.ntp.org iburst maxsources 1
  pool 2.ubuntu.pool.ntp.org iburst maxsources 2
  ~
  systemctl restart chrony
  ```

  other node

  ​	controller node를 바라보도록 설정

  ~~~bash
  apt install chrony
  vim /etc/chrony/chrony.conf
  ~
  # About using servers from the NTP Pool Project in general see (LP: #104525).
  # Approved by Ubuntu Technical Board on 2011-02-08.
  # See http://www.pool.ntp.org/join.html for more information.
  # pool ntp.ubuntu.com        iburst maxsources 4
  # pool 0.ubuntu.pool.ntp.org iburst maxsources 1
  # pool 1.ubuntu.pool.ntp.org iburst maxsources 1
  # pool 2.ubuntu.pool.ntp.org iburst maxsources 2
  server controller iburst
  ~
  systemctl restart chrony
  chronyc sources
  MS Name/IP address         Stratum Poll Reach LastRx Last sample               
  ===============================================================================
  ^? controller                    0   6     0     -     +0ns[   +0ns] +/-    0ns
  ~~~

- **repository 설정**

  https://docs.openstack.org/install-guide/environment-packages-ubuntu.html

  ubuntu 22.04 기본 repo는 yoga를 지원함

- **SQL Database 설치**

  controller node

  ```bash
  apt install -y mariadb-server python3-pymysql
  
  vim /etc/mysql/mariadb.conf.d/99-openstack.cnf
  [mysqld]
  bind-address = 10.0.0.11
  
  default-storage-engine = innodb
  innodb_file_per_table = on
  max_connections = 4096
  collation-server = utf8_general_ci
  character-set-server = utf8
  
  service mysql restart
  mysql_secure_installation
  ```

- **SQL Database 설치**

  ```bash
  apt install -y rabbitmq-server
  rabbitmqctl add_user openstack qwe1212
  rabbitmqctl set_permissions openstack ".*" ".*" ".*"
  Setting permissions for user "openstack" in vhost "/" ...
  ```

- **Memcached 설치**

  ```bash
  apt install memcached python-memcache
  vim /etc/memcached.conf
  # Specify which IP address to listen on. The default is to listen on all IP addresses
  # This parameter is one of the only security measures that memcached has, so make sure
  # it's listening on a firewalled interface.
  -l 10.101.0.3 # 기존 내용을 수정
  
  service memcached restart
  ```

- **etcd 설치**

  ```bash
  apt install etcd
  vim /etc/default/etcd
  ETCD_NAME="controller"
  ETCD_DATA_DIR="/var/lib/etcd"
  ETCD_INITIAL_CLUSTER_STATE="new"
  ETCD_INITIAL_CLUSTER_TOKEN="etcd-cluster-01"
  ETCD_INITIAL_CLUSTER="controller=http://10.101.0.3:2380"
  ETCD_INITIAL_ADVERTISE_PEER_URLS="http://10.101.0.3:2380"
  ETCD_ADVERTISE_CLIENT_URLS="http://10.101.0.3:2379"
  ETCD_LISTEN_PEER_URLS="http://0.0.0.0:2380"
  ETCD_LISTEN_CLIENT_URLS="http://10.101.0.3:2379"
  
  systemctl enable etcd
  systemctl restart etcd
  ```

  

[[2. openstack_install_service]]
[[3. openstack_install_keystone]]
[[4. openstack_install_glance]]
[[5. openstack_install_placement]]
[[6. openstack_install_nova]]